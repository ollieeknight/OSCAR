<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSCAR Metadata Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; }
        .container { max-width: 100%; margin: 0 auto; padding: 10px; box-sizing: border-box; }
        .row { margin-bottom: 10px; display: flex; flex-direction: row; flex-wrap: wrap; }
        .row label { width: 150px; } /* Fixed width for labels */
        .row select, .row input { flex: 1; min-width: 120px; box-sizing: border-box; margin: 5px; }
        button { margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>OSCAR Metadata Generator</h1>
        <form id="csvForm">
            <div id="rowsContainer">
                <div class="row">
                    <label for="assay">Assay</label>
                    <select id="assay" name="assay" required>
                        <option value="">Select Assay</option>
                        <option value="GEX">GEX</option>
                        <option value="CITE">CITE</option>
                        <option value="DOGMA">DOGMA</option>
                        <option value="ATAC">ATAC</option>
                        <option value="ASAP">ASAP</option>
                    </select>
                    <label for="experiment_id">Experiment ID</label>
                    <input type="text" id="experiment_id" name="experiment_id" required>
                    <label for="historical_number">Historical Number</label>
                    <input type="text" id="historical_number" name="historical_number" required>
                    <label for="replicate">Replicate</label>
                    <input type="text" id="replicate" name="replicate" required>
                    <label for="modality">Modality</label>
                    <select id="modality" name="modality" required>
                        <option value="">Select Modality</option>
                        <option value="Single Cell">Single Cell</option>
                        <option value="Bulk">Bulk</option>
                    </select>
                    <label for="chemistry">Chemistry</label>
                    <select id="chemistry" name="chemistry" required>
                        <option value="">Select Chemistry</option>
                        <option value="Chemistry 1">Chemistry 1</option>
                        <option value="Chemistry 2">Chemistry 2</option>
                    </select>
                    <label for="index_type">Index Type</label>
                    <select id="index_type" name="index_type" required>
                        <option value="">Select Index Type</option>
                        <option value="Index Type 1">Index Type 1</option>
                        <option value="Index Type 2">Index Type 2</option>
                    </select>
                    <label for="index">Index</label>
                    <select id="index" name="index" required>
                        <option value="">Select Index</option>
                        <option value="Index 1">Index 1</option>
                        <option value="Index 2">Index 2</option>
                    </select>
                    <label for="species">Species</label>
                    <select id="species" name="species" required>
                        <option value="">Select Species</option>
                        <option value="Human">Human</option>
                        <option value="Mouse">Mouse</option>
                    </select>
                    <label for="n_donors">Number of Donors</label>
                    <input type="text" id="n_donors" name="n_donors" required>
                    <label for="adt_file">ADT File</label>
                    <input type="text" id="adt_file" name="adt_file" required>
                </div>
            </div>
            <button type="button" onclick="addRow()">Add Row</button>
            <button type="button" onclick="generateCSV()">Generate CSV</button>
        </form>
    </div>
    
    <script>
        function addRow() {
            const container = document.getElementById('rowsContainer');
            const newRow = document.createElement('div');
            newRow.className = 'row';
            newRow.innerHTML = `
                <label for="assay">Assay</label>
                <select id="assay" name="assay" required>
                    <option value="">Select Assay</option>
                    <option value="GEX">GEX</option>
                    <option value="CITE">CITE</option>
                    <option value="DOGMA">DOGMA</option>
                    <option value="ATAC">ATAC</option>
                    <option value="ASAP">ASAP</option>
                </select>
                <label for="experiment_id">Experiment ID</label>
                <input type="text" id="experiment_id" name="experiment_id" required>
                <label for="historical_number">Historical Number</label>
                <input type="text" id="historical_number" name="historical_number" required>
                <label for="replicate">Replicate</label>
                <input type="text" id="replicate" name="replicate" required>
                <label for="modality">Modality</label>
                <select id="modality" name="modality" required>
                    <option value="">Select Modality</option>
                    <option value="Single Cell">Single Cell</option>
                    <option value="Bulk">Bulk</option>
                </select>
                <label for="chemistry">Chemistry</label>
                <select id="chemistry" name="chemistry" required>
                    <option value="">Select Chemistry</option>
                    <option value="Chemistry 1">Chemistry 1</option>
                    <option value="Chemistry 2">Chemistry 2</option>
                </select>
                <label for="index_type">Index Type</label>
                <select id="index_type" name="index_type" required>
                    <option value="">Select Index Type</option>
                    <option value="Index Type 1">Index Type 1</option>
                    <option value="Index Type 2">Index Type 2</option>
                </select>
                <label for="index">Index</label>
                <select id="index" name="index" required>
                    <option value="">Select Index</option>
                    <option value="Index 1">Index 1</option>
                    <option value="Index 2">Index 2</option>
                </select>
                <label for="species">Species</label>
                <select id="species" name="species" required>
                    <option value="">Select Species</option>
                    <option value="Human">Human</option>
                    <option value="Mouse">Mouse</option>
                </select>
                <label for="n_donors">Number of Donors</label>
                <input type="text" id="n_donors" name="n_donors" required>
                <label for="adt_file">ADT File</label>
                <input type="text" id="adt_file" name="adt_file" required>
            `;
            container.appendChild(newRow);
        }

        function generateCSV() {
            const rows = document.querySelectorAll('.row');
            let csvContent = 'assay,experiment_id,historical_number,replicate,modality,chemistry,index_type,index,species,n_donors,adt_file\n';
            rows.forEach(row => {
                const values = Array.from(row.querySelectorAll('input, select')).map(input => input.value);
                csvContent += values.join(',') + '\n';
            });

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'data.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
    </script>
</body>
</html>
